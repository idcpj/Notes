[TOC]
## demo
参考 [个人github](https://github.com/idcpj/go_websocket)

## 推送的高并发解决方案
### 内核优化
把同一秒内要推送的弹幕,合并成一条,如每条发送10条的数,合并为10条同时发送

## 锁瓶颈-优化方案
1. 连接打散到多个集合中,每个集合有自己的锁
2. 多线程并发推送多个集合,避免锁竞争
3. 读写锁取代互斥锁,多个推送任务可以并发遍历相同集合

## 单机瓶颈
1. 维护海量长连接会花费不少内存
2. 消息推送瞬时消耗大量CPU资源
3. 消息推送瞬时带宽高达400~600MB(4-6Gbiⅰts),是主要瓶颈!